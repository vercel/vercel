{"version":3,"sources":["../src/types.ts"],"sourcesContent":["import type { ErrorPayload, ConfigEnv, CustomPayload } from 'vite'\nimport type { Worker } from 'worker_threads'\nimport type { ESLint } from 'eslint'\nimport type { VlsOptions } from './checkers/vls/initParams'\n\n/* ----------------------------- userland plugin options ----------------------------- */\n\ninterface TsConfigOptions {\n  /**\n   * path to tsconfig.json file\n   */\n  tsconfigPath: string\n  /**\n   * root path of cwd\n   */\n  root: string\n  /**\n   * root path of cwd\n   */\n  buildMode: boolean\n}\n\n/**\n * TypeScript checker configuration\n * @default true\n */\nexport type TscConfig =\n  /**\n   * - set to `true` to enable type checking with default configuration\n   * - set to `false` to disable type checking, you can also remove `config.typescript` directly\n   */\n  boolean | Partial<TsConfigOptions>\n\n/** vue-tsc checker configuration */\nexport type VueTscConfig =\n  /**\n   * - set to `true` to enable type checking with default configuration\n   * - set to `false` to disable type checking, you can also remove `config.vueTsc` directly\n   */\n  boolean | Partial<Omit<TsConfigOptions, 'buildMode'>>\n\n/** vls checker configuration */\nexport type VlsConfig = boolean | DeepPartial<VlsOptions>\n\n/** ESLint checker configuration */\nexport type EslintConfig =\n  | false\n  | {\n      /**\n       * lintCommand will be executed at build mode, and will also be used as\n       * default config for dev mode when options.eslint.dev.eslint is nullable.\n       */\n      lintCommand: string\n      dev?: Partial<{\n        /** You can override the options of translated from lintCommand. */\n        overrideConfig: ESLint.Options\n        /** which level of the diagnostic will be emitted from plugin */\n        logLevel: ('error' | 'warning')[]\n      }>\n    }\n\nexport enum DiagnosticLevel {\n  Warning = 0,\n  Error = 1,\n  Suggestion = 2,\n  Message = 3,\n}\n\ntype ErrorPayloadErr = ErrorPayload['err']\nexport interface DiagnosticToRuntime extends ErrorPayloadErr {\n  checkerId: string\n  level?: DiagnosticLevel\n}\n\n/** checkers shared configuration */\nexport interface SharedConfig {\n  /**\n   * Show overlay on UI view when there are errors or warnings in dev mode.\n   * - Set `true` to show overlay\n   * - Set `false` to disable overlay\n   * - Set with a object to customize overlay\n   *\n   * @defaultValue `true`\n   */\n  overlay:\n    | boolean\n    | {\n        /**\n         * Set this true if you want the overlay to default to being open if errors/warnings are found\n         * @defaultValue `true`\n         */\n        initialIsOpen?: boolean\n        /**\n         * The position of the vite-plugin-checker badge to open and close the diagnostics panel\n         * @default `bl`\n         */\n        position?: 'tl' | 'tr' | 'bl' | 'br'\n        /**\n         * Use this to add extra style to the badge button\n         * For example, if you want to want with react-query devtool, you can pass 'margin-left: 100px;' to avoid the badge overlap with the react-query's\n         */\n        badgeStyle?: string\n      }\n  /**\n   * stdout in terminal which starts the Vite server in dev mode.\n   * - Set `true` to enable\n   * - Set `false` to disable\n   *\n   * @defaultValue `true`\n   */\n  terminal: boolean\n  /**\n   * Enable checking in build mode\n   * @defaultValue `true`\n   */\n  enableBuild: boolean\n}\n\nexport interface BuildInCheckers {\n  typescript: TscConfig\n  vueTsc: VueTscConfig\n  vls: VlsConfig\n  eslint: EslintConfig\n}\n\nexport type BuildInCheckerNames = keyof BuildInCheckers\n\nexport type PluginConfig = SharedConfig & BuildInCheckers\n\n/** Userland plugin configuration */\nexport type UserPluginConfig = Partial<PluginConfig>\n\n/* ----------------------------- worker actions ----------------------------- */\n\nexport enum ACTION_TYPES {\n  config = 'config',\n  configureServer = 'configureServer',\n  overlayError = 'overlayError',\n  console = 'console',\n  unref = 'unref',\n}\n\ninterface Action {\n  type: string\n  payload: unknown\n}\n\nexport interface OverlayErrorAction extends Action {\n  type: ACTION_TYPES.overlayError\n  /**\n   * send `CustomPayload` to raise error overlay provided by Vite\n   * send `null` to clear overlay for current checker\n   */\n  payload: CustomPayload | null\n}\n\ninterface ConfigActionPayload {\n  enableOverlay: boolean\n  enableTerminal: boolean\n  env: ConfigEnv\n}\n\nexport interface ConfigAction extends Action {\n  type: ACTION_TYPES.config\n  payload: ConfigActionPayload\n}\n\nexport interface ConfigureServerAction extends Action {\n  type: ACTION_TYPES.configureServer\n  payload: {\n    root: string\n  }\n}\n\nexport interface UnrefAction extends Action {\n  type: ACTION_TYPES.unref\n}\n\nexport type Actions = OverlayErrorAction | ConfigAction | ConfigureServerAction | UnrefAction\n\n/* ----------------------------- internal types ----------------------------- */\n\n// prepare for create serve & build checker\n\nexport type BuildCheckBin = BuildCheckBinStr | BuildCheckBinFn\nexport type BuildCheckBinStr = [string, ReadonlyArray<string>]\nexport type BuildCheckBinFn = (config: UserPluginConfig) => [string, ReadonlyArray<string>]\n\nexport interface ConfigureServeChecker {\n  worker: Worker\n  config: (config: ConfigAction['payload']) => void\n  configureServer: (serverConfig: ConfigureServerAction['payload']) => void\n}\n\nexport interface ServeAndBuildChecker {\n  serve: ConfigureServeChecker\n  build: { buildBin: BuildCheckBin; buildFile?: string }\n}\n\n/**\n * create serve & build checker\n */\n\nexport interface ServeChecker<T extends BuildInCheckerNames = any> {\n  createDiagnostic: CreateDiagnostic<T>\n}\n\nexport interface CheckerDiagnostic {\n  config: (options: ConfigActionPayload) => unknown\n  configureServer: (options: { root: string }) => unknown\n}\n\nexport type CreateDiagnostic<T extends BuildInCheckerNames = any> = (\n  config: Pick<BuildInCheckers, T> & SharedConfig\n) => CheckerDiagnostic\n\n/* ----------------------------- generic utility types ----------------------------- */\n\nexport type DeepPartial<T> = {\n  [P in keyof T]?: DeepPartial<T[P]>\n}\n"],"mappings":";;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA6DO,IAAK,kBAAL,kBAAK,qBAAL;AACL,iDAAU,KAAV;AACA,+CAAQ,KAAR;AACA,oDAAa,KAAb;AACA,iDAAU,KAAV;AAJU;AAAA;AAyEL,IAAK,eAAL,kBAAK,kBAAL;AACL,4BAAS;AACT,qCAAkB;AAClB,kCAAe;AACf,6BAAU;AACV,2BAAQ;AALE;AAAA;","names":[]}